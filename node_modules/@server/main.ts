import * as http from "http";
import * as express from "express";
import {Server as WSServer} from "ws";

const port = 8000;

let server = http.createServer();
let app = express();
let wss = new WSServer({ server: server });

server.on("request", app);
server.listen(port, () => {
	console.log("Server listening!");
});

wss.on("connection", (ws) => {
	ws.on("message", message => {
		console.log("Received", message);
		ws.send(message);
	});
});

app.use("/static", express.static("static"));

app.get("/", (req, res) => {
	res.sendFile("static/index.html", {
		root: process.cwd()
	});
});

app.get("/test", (req, res) => {
	res.send(JSON.stringify({
		message: "This is a test message!"
	}));
});

export default class X {}
export {default as Y} from "./module";