"use strict";

const core = require("./core");
const load = core.load;

console.log(`Building ${ core.name }`);
console.log(`Using guh v${ core.version }`);
console.log(`Loading dependencies`);

const gulp = load("gulp");
const gutil = load("gulp-util");
const browserSync = load("browser-sync").create();

core.browserSync = browserSync;

for (const module of core.modules) {
	require("./" + module);
}

gulp.task("default", () => {
	if (core.watch) {
		if (core.useBrowsersync) {
			let bsSettings = core.preset.browserSync != null ? core.preset.browserSync : core.conf.browserSync;

			if (bsSettings) {
				browserSync.init(bsSettings);
			} else {
				gutil.log(gutil.colors.yellow("In order to use, Browsersync, add a 'browserSync' entry in your guh config!"));
			}
		}
	}

	return gulp.start(core.buildTasks);
});