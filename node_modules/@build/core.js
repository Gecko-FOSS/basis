"use strict";

let conf = require("../../build.conf");

let core = {
	version: "2.0.0",

	modules: ["browser", "server", "styles", "static"],
	buildTasks: [],

	conf: conf,
	browserSync: null,
	once: conf.once,

	load: (path) => {
		try {
			return require(path);
		} catch(e) {
			console.log(`Couldn't load module "${path}", try running "npm install"`);
			process.exit();
		}
	},

	getBuildPath: () => core.conf.debug ? core.conf.debugPath : core.conf.releasePath,

	getName: (transform) => {
		if (transform.name) {
			return transform.name;
		}

		return transform.type.charAt(0).toUpperCase() + transform.type.slice(1);
	},

	getTransforms: (type) => {
		let out = [];

		for (let module of core.conf.transforms) {
			if (module.type === type) {
				out.push(module);
			}
		}

		return out;
	},

	onError: function(err) {
		require("gulp-notify").onError("Error: <%= error.message %>")(err);

		this.emit("end");
	}
};

module.exports = core;